<section
    class="flex flex-col flex-none overflow-auto w-24 hover:w-64 group lg:max-w-sm md:w-2/5 transition-all duration-300 ease-in-out">
    <!-- Sidebar Header -->
    <div class="header p-4 flex flex-row justify-between items-center flex-none">
        <a href="/logout" class="flex items-center text-lg text-blue-500 hover:text-blue-600">
            <i class="fas fa-sign-out-alt mr-2" style="font-size: 30px;"></i>
        </a>
        <p class="text-md font-bold hidden hover:text-blue-600  md:block group-hover:block text-blue-500 text-2xl cursor-pointer"
            onclick="window.location.href='/chat'">Chats</p>
        <a
            class="create-chat-btn block rounded-full hover:bg-blue-600 bg-blue-500 w-10 h-10 p-2 hidden md:block group-hover:block cursor-pointer">
            <svg viewBox="0 0 24 24" class="w-full h-full fill-current text-white">
                <path
                    d="M6.3 12.3l10-10a1 1 0 0 1 1.4 0l4 4a1 1 0 0 1 0 1.4l-10 10a1 1 0 0 1-.7.3H7a1 1 0 0 1-1-1v-4a1 1 0 0 1 .3-.7zM8 16h2.59l9-9L17 4.41l-9 9V16zm10-2a1 1 0 0 1 2 0v6a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V6c0-1.1.9-2 2-2h6a1 1 0 0 1 0 2H4v14h14v-6z" />
            </svg>
        </a>
    </div>
    <!-- Search Bar -->
    <div class="search-box p-4 flex-none">
        <form>
            <div class="relative">
                <label>
                    <input id="searchInput"
                        class="rounded-full py-2 pr-6 pl-10 w-full border border-blue-800 focus:border-blue-700 bg-blue-100 focus:bg-blue-200 focus:outline-none text-gray-800 focus:shadow-md transition duration-300 ease-in"
                        type="text" value="" placeholder="Search Messenger" oninput="searchRooms(this.value)" />
                    <span class="absolute top-0 left-0 mt-2 ml-3 inline-block">
                        <svg viewBox="0 0 24 24" class="w-6 h-6 text-blue-500">
                            <path fill="currentColor"
                                d="M16.32 14.9l5.39 5.4a1 1 0 0 1-1.42 1.4l-5.38-5.38a8 8 0 1 1 1.41-1.41zM10 16a6 6 0 1 0 0-12 6 6 0 0 0 0 12z" />
                        </svg>
                    </span>
                </label>
            </div>
        </form>
    </div>


    <!-- Room List -->
    <div class="contacts p-2 flex-1 overflow-y-scroll" id="roomList">
        {% for room in rooms %}
        <a class="contact-item mb-2 flex justify-between items-center p-3 hover:bg-blue-100 rounded-lg relative shadow-md border border-gray-100 hover:border-blue-300"
            href="/chat/{{room.room_name}}">
            <div class="w-16 h-16 relative flex flex-shrink-0 rounded-full overflow-hidden">
                <img class="w-full h-full object-cover" src="https://loremflickr.com/640/480?lock=1{{ room.member_id }}"
                    alt="chat-user" />
            </div>
            <div class="info-container flex-auto min-w-0 ml-4 mr-6 hidden md:block group-hover:block">
                <p class="room-name text-blue-500 font-bold">{{ room.room_name }}</p>
                <div class="flex items-center justify-between text-sm text-gray-600">
                    <div class="message-info min-w-0">
                        <p class="truncate">
                            {% if room.get_last_message() %}
                            {{ room.get_last_message().sender_name }}: {{
                            room.get_last_message().message }}
                            {% else %}
                            No messages yet
                            {% endif %}
                        </p>
                    </div>
                    <p class="timestamp ml-2 whitespace-no-wrap text-blue-500">
                        {% if room.get_last_message() is not none %}
                        {{ room.get_last_message().created_at}}
                        {% endif %}
                    </p>
                </div>
            </div>
        </a>
        {% endfor %}
    </div>

    <script>
        function searchRooms(query) {
            query = query.toLowerCase().trim();
            const roomList = document.getElementById('roomList');
            const rooms = roomList.getElementsByClassName('contact-item');

            Array.from(rooms).forEach(function (room) {
                const roomName = room.querySelector('.room-name').textContent.toLowerCase();
                if (roomName.includes(query)) {
                    room.style.display = '';
                } else {
                    room.style.display = 'none';
                }
            });
        }
    </script>
</section>